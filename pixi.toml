[workspace]
name = "blazeqc"
version = "0.1.0"
description = "Fast quality control for sequencing data in Mojo."
authors = ["MoSafi2 <mohamed.mabrouk@rwth-aachen.de>"]
channels = [
    "https://conda.modular.com/max-nightly",
    "https://repo.prefix.dev/modular-community",
    "conda-forge",
    "bioconda",
    "https://prefix.dev/pixi-build-backends",
]
platforms = ["linux-64", "osx-arm64"]
license = "MIT"
preview = ["pixi-build"]

[package]
name = "blazeqc"
version = "0.1.0"

[package.build]
backend = { name = "pixi-build-mojo", version = "0.*", channels = [
    "https://prefix.dev/pixi-build-backends",
    "https://prefix.dev/conda-forge",
] }

[package.host-dependencies]
mojo-compiler = "==0.26.1.0"

[package.build-dependencies]
mojo-compiler = "==0.26.1.0"
rattler-build = "*"

[package.run-dependencies]
mojo-compiler = "==0.26.1.0"

[dependencies]
mojo = "==0.26.1.0"
matplotlib = ">=3.10.6,<4"
numpy = ">=2.3.3,<3"
seaborn = ">=0.13.2,<0.14"
ipykernel = ">=6.31.0,<7"
falco = ">=1.2.5,<2"
fastp = ">=1.0.1,<2"
python = ">=3.14.0,<3.15"
blazeseq = { git = "https://github.com/MoSafi2/BlazeSeq", branch = "main" }
fastqc = ">=0.12.1,<0.13"

[tasks]
test = "mojo run -I BlazeQC.mojopkg -D ASSERT=all tests/test_helpers.mojo && mojo run -I BlazeQC.mojopkg -D ASSERT=all tests/test_helpers_python.mojo"
build = "mojo package blazeqc -o BlazeQC.mojopkg"
t = { cmd = "sh -c 'find ./tests -name test_*.mojo | xargs -I % mojo test -I BlazeQC.mojopkg -D ASSERT=all %'", depends-on = [
    "build",
] }
rbuild = "pixi build"
rtest = { cmd = "sh -c 'PKG=$(ls ./blazeqc*.conda 2>/dev/null || find .pixi/build -name \"blazeqc*.conda\" -type f 2>/dev/null | head -1); test -n \"$PKG\" && rattler-build test -c conda-forge -c https://conda.modular.com/max --package-file \"$PKG\"'", depends-on = [
    "rbuild",
] }
